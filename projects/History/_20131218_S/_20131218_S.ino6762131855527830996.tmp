volatile int c1 = 0;
#define ledPin 13

void setup() {
  // put your setup code here, to run once:
  Serial.begin(57600);
  Serial.println("Start");

  attachInterrupt(0, blink, FALLING);

  pinMode(ledPin, OUTPUT);
  
  // initialize timer1 
  noInterrupts();           // disable all interrupts
  TCCR2A = 0;
  TCCR2B = 0;
  TCNT2  = 0;

  OCR2A = 150;              // compare match register 16MHz/256/2Hz
  TCCR2B |= (1 << WGM21);   // CTC mode
  TCCR2B |= (1 << CS11)              ; //    8 prescaler 
//TCCR2B |= (1 << CS11) | (1 << CS10); //   64 prescaler 
//TCCR2B |= (1 << CS12)              ; //  256 prescaler 
//TCCR2B |= (1 << CS12) | (1 << CS10); // 1024 prescaler 
  TIMSK2 |= (1 << OCIE2A);  // enable timer compare interrupt
  interrupts();             // enable all interrupts
}
volatile uint16_t scaler=0;
volatile uint32_t isrI;

ISR(TIMER2_COMPA_vect)          // timer compare interrupt service routine
{// if (scaler ++ > 18310) {
    digitalWrite(ledPin, digitalRead(ledPin) ^ 1);   // toggle LED pin
//    TCNT2 = 105;            // compare match register 16MHz/256/2Hz
//      digitalWrite(ledPin, HIGH);
//    for (isrI = 0; isrI < 200; isrI++) {
//    }
//      digitalWrite(ledPin, LOW);
 //   scaler = 0;
 // }
}

uint32_t t;
void loop() {
  // put your main code here, to run repeatedly:
  if (millis() - t > 1000) {
    t=millis();
    Serial.println(c1);
  }
}

void blink()
{
    digitalWrite(ledPin, HIGH);
    for (uint32_t i = 0; i<100000; i++) {
      ;
    }
    digitalWrite(ledPin, LOW);
    c1++;
}
